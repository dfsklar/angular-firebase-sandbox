<p>Logged in as user: {{user.displayName}} <i>{{user.email}}</i>
&nbsp; &nbsp; &bull; &nbsp;
    <button ng-click="doLogout()">Logout</button>
</p>

<p ng-controller="ProductListController">
    <img src="{{products[productID].image}}" height="150"/>
</p>


<table class="review-presentation">
    <tbody>



    <!-- WRITEABLE REVIEW:

    The writeable review UI changes slightly based on whether this user has or has not already issued
    a review for this product.

    If the user *has* already submitted a review for this product, the UI shows that previously-submitted
    review and the user is allowed to revise and resubmit.
    -->

    <tr ng-if="userHasNotYetReviewed">
        <td class="buffer" colspan="3" style="padding-top:52px">
            <b>Hey!  If you've tried out this product, please give your rating and comments right here!</b>
        </td>
    </tr>
    <tr ng-if="!userHasNotYetReviewed">
        <td class="buffer" colspan="3" style="padding-top:52px">
            <b>Thanks for your previous review of this product.  Below we show the rating and commentary you provided earlier &mdash;
                you can revise it if you'd like!</b>
        </td>
    </tr>

    <tr>

        <td></td>
        <td class="commentary">
            <!-- In controller:  $scope.writeableReview has been setup -->
            <rating-starstrip ng-model='writeableReview.rating' value="{{writeableReview.rating}}"></rating-starstrip>
            <br/><textarea style="width:450px"
                           placeholder="Click on the stars to select your rating (from 1 to 5 stars), and type in this box to provide your comments."
                           ng-model="writeableReview.comment"></textarea><br/>
        </td>
        <td>
            <button ng-if="!userHasNotYetReviewed" ng-click="update_review()">Revise</button>
            <button ng-if=" userHasNotYetReviewed" ng-click="push_review_to_server()">Submit</button>
        </td>
    </tr>







    <tr>
        <td class="buffer" colspan="3" style="padding-top:52px">
            <b>Below are the most recent 20 reviews made by others:</b>
        </td>
    </tr>

    <!-- this reference to controller.xxxx is satisfied by the controller's "this.xxxx" not be the $scope! -->
    <tr ng-repeat="review in reviewlistCTRLR.reviewsToShow | filter:filter_to_only_others()">
        <td><b>{{review.authorName}}</b>
            <br/><i>{{review.authorEmail}}</i><br/><img width=24 src="{{review.photoURL}}"/></td>
        <td class="commentary">
            <rating-starstrip readonly value="{{review.rating}}"></rating-starstrip>
            <p>{{review.comment}}</p>
        </td>
    </tr>
</tbody>
</table>

