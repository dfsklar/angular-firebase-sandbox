<p class="login-panel">Logged in as user: &nbsp; <b>{{user.displayName}}</b> &nbsp; <i>{{user.email}}</i>
    &nbsp; &nbsp; &bull; &nbsp;
    <button ng-click="doLogout()">Logout</button>
    <br/>&nbsp;<br/>
    <a href="#/" style='font-size:16px'>&lt;&lt;&lt;&lt;&lt;&lt;&lt; Go back to list of products</a>
</p>



<p ng-controller="ProductListController">
    <img src="{{products[productID].image}}" height="150"/>
</p>


<table class="review-presentation">
    <tbody>


    <!-- WRITEABLE REVIEW:

    The writeable review UI changes slightly based on whether this user has or has not already issued
    a review for this product.

    If the user *has* already submitted a review for this product, the UI shows that previously-submitted
    review and the user is allowed to revise and resubmit.
    -->

    <tr ng-if="userHasNotYetReviewed">
        <td class="buffer" colspan="3" style="padding-top:22px">
            <b>Hey - you <u>have not yet reviewed</u> this product!  Have you watched this show?</b>
        </td>
    </tr>

    <tr ng-if="!userHasNotYetReviewed">

        <td class="buffer" colspan="3" style="padding-top:52px">
            <b>Thanks for your <u>previous review</u> of this product!<br/>
               You can <u>revise it if you'd like</u>!</b>
        </td>
    </tr>
    <tr ng-if="!userHasNotYetReviewed">
        <td><b>{{writeableReview.authorName}}</b>
            <br/><i>{{writeableReview.authorEmail}}</i>
            <br/>{{writeableReview.time | date:'yyyy-MMM-dd'}}
            <br/><img class='photo-of-commenter' width=24 src="{{writeableReview.photoURL}}"/>
        </td>
        <td class="commentary">
            <rating-starstrip readonly value="{{writeableReview.rating}}"></rating-starstrip>
            <p class="readonly-headline">{{writeableReview.headline}}</p>
            <p class="readonly-commentary">{{writeableReview.comment}}</p>
        </td>

            <td>
            <md-button class="md-primary md-raised" ng-click="popupReviewDialog($event)">
            Revise!
        </md-button></td>
    </tr>


    <tr ng-if="userHasNotYetReviewed">
        <td colspan=2>
            You have not yet reviewed this.
            <br/>
            <md-button class="md-primary md-raised" ng-click="popupReviewDialog($event)">
                Rate this!
            </md-button>
        </td>
    <!-- In controller:  $scope.writeableReview has been setup -->
    </tr>





    <tr>
        <td class="buffer" colspan="3" style="padding-top:52px">
            <b>Below are the most recent 20 reviews made by others:</b>
        </td>
    </tr>

    <!-- this reference to controller.xxxx is satisfied by the controller's "this.xxxx" not be the $scope! -->
    <tr ng-repeat="review in reviewlistCTRLR.reviewsToShow | filter:filter_to_only_others()">
        <td><b>{{review.authorName}}</b>
          <br/><i>{{review.authorEmail}}</i>
          <br/>{{review.time | date:'yyyy-MMM-dd'}}
          <br/><img class='photo-of-commenter' width=24 src="{{review.photoURL}}"/>
        </td>
        <td class="commentary">
            <rating-starstrip readonly value="{{review.rating}}"></rating-starstrip>
            <p class="readonly-headline">{{review.headline}}</p>
            <p class="readonly-commentary">{{review.comment}}</p>
        </td>
    </tr>
</tbody>
</table>




<script type="text/ng-template" id="dialog1.tmpl.html">
    <md-dialog aria-label="Mango (Fruit)">
<form ng-cloak>
    <md-dialog-content>
        <div class="md-dialog-content" style="text-align:center">
            <p>RATING</p>
        <rating-starstrip ng-model='writeableReview.rating' ng-if='writeableReview.rating' value="{{writeableReview.rating}}"></rating-starstrip>
                <br/>
            <input type="text" placeholder="Enter a headline/title here" ng-model="writeableReview.headline"/>
            <br/>
            <textarea style="width:350px;height:220px"
                               placeholder="Click on the stars to select your rating (from 1 to 5 stars), and type in this box to provide your comments."
                               ng-model="writeableReview.comment"></textarea><br/>
            <md-button class="md-primary md-raised"  ng-if="!userHasNotYetReviewed" ng-click="update_review()">Revise</md-button>
            <md-button class="md-primary md-raised"  ng-if=" userHasNotYetReviewed" ng-click="push_review_to_server()">SAVE</md-button>
        </div>
    </md-dialog-content>
    <md-dialog-actions></md-dialog-actions>
</form>
    </md-dialog>
</script>

